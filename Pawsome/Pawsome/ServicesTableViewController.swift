//
//  ServicesTableViewController.swift
//  Pawsome
//
//  Created by Josefin Lindvall on 2019-11-08.
//  Copyright Â© 2019 ProjectGroupM. All rights reserved.
//

import UIKit

class ServicesTableViewController: UITableViewController
{
    var services = [[Service]]() //Array containing arrays that in turn contain elements of class Service
    var ServicesOptional : [[Any]] = []
    var veterinarians = [Service]()
    var dogSitters = [Service]()
    var dogGroomers = [Service]()
    
    var headersForSections = ["Veterinarians" , "Dog sitters" , "Dog groomers"]
    
    
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    
    
    
    override func viewDidLoad()
    {
        super.viewDidLoad()
        
        self.navigationItem.title = "Services"
        
        self.navigationItem.rightBarButtonItem = self.editButtonItem
        
        // Fetch data from database here, put the data in the arrays veterinarians, dogSitters, dogGroomers
        
        veterinarians.append(Service ("veterinarian", "Vet Kelly" , "12345678910" , "Paw street 20" , "www.kelly.com", "kelly@gmail.com"))
        dogSitters.append(Service ("dogSitter", "Bruno the dog sitter" , "12345678910" ,"Tail street 20" ,  "www.bruno.com" , "bruno@gmail.com"))
        dogGroomers.append(Service ("dogGroomer", "Sara the groomer" , "12345678910" , "Fur street 20" , "www.sara.com", "sara@gmail.com" ))

        
        services = [veterinarians, dogSitters, dogGroomers]
        
    }
    
    override func viewWillAppear(_ animated: Bool)
    {
        tableView.reloadData()
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    
    override func numberOfSections(in tableView: UITableView) -> Int
        {
            return services.count
        }

    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int
        {
            return services[section].count
        }

    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell
        {
            let cell = tableView.dequeueReusableCell(withIdentifier: "cellInServicesTable", for: indexPath) as! cellInServicesTable
            
            let currentElementInServicesArray = services[indexPath.section][indexPath.row]
            cell.nameLabel.text = currentElementInServicesArray.name
            cell.telephoneNumberLabel.text = currentElementInServicesArray.telephoneNumber


            return cell
        }
        
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        
        override func tableView(_ tableView: UITableView, titleForHeaderInSection section: Int) -> String?
        {
            return headersForSections[section]
        }
        
        
   /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        
        override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath)
        {
            performSegue(withIdentifier: "segueToServiceDetailViewController", sender: indexPath) // Function performSegue will call function "prepare for segue" below
            
        }
        
      
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        override func prepare(for segue: UIStoryboardSegue, sender: Any?)
        {
            
           if segue.identifier == "segueToServiceDetailViewController" ,
              let segueTo =  segue.destination as? ServiceDetailViewController ,
              let index = sender as? IndexPath
           {
                let service = services[index.section][index.row]
                segueTo.service = service
                            
           }
         }
        
      
    
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        
    // Override to support conditional editing of the table view.
    override func tableView(_ tableView: UITableView, canEditRowAt indexPath: IndexPath) -> Bool
    {
        // Return false if you do not want the specified item to be editable.
        return true
    }
    

    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


    
    // Override to support editing the table view.
    override func tableView(_ tableView: UITableView, commit editingStyle: UITableViewCell.EditingStyle, forRowAt indexPath: IndexPath)
    {
        if editingStyle == .delete
        {
            // Delete the row from the data source
            tableView.deleteRows(at: [indexPath], with: .fade)
        }
        
        
    }
   
    
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    
    
}



